#!/usr/bin/env bash

# Perform backupth

me=$(basename ${0})

if [ ${UID} != 0 ]
then
   echo "${me}> must be root..." >&2
   exit -1
fi

source ${HOME}/.bupthrc

for fs2bs in ${fs2bs_map}
do

   fs=$(cut --fields=1 --delimiter=${map_delimiter} <<< ${fs2bs})
   bs=$(cut --fields=2 --delimiter=${map_delimiter} <<< ${fs2bs})

   if [ -d ${fs} ]
   then

      echo "${me}> backing up \"${fs}\"..."
      ${bupth} index --update --one-file-system ${fs}
      ${bupth} save  --name=${bs}               ${fs}

   else
      echo "${me}> \"${fs}\" is not accessible, skipping..."
   fi

done
