#!/usr/bin/env bash

# Perform backupth

ME=$(basename ${0})

if [ ${UID} != 0 ]
then
   echo "${ME}> must be root..." >&2
   exit -1
fi

source ${HOME}/.bupthrc

for FS2BS in ${FS2BS_MAP}
do

   FS=$(cut --fields=1 --delimiter=${MAP_DELIMITER} <<< ${FS2BS})
   BS=$(cut --fields=2 --delimiter=${MAP_DELIMITER} <<< ${FS2BS})

   if [ -d ${FS} ]
   then

      echo "${ME}> backing up \"${FS}\"..."
      ${BUPTH} index --update --one-file-system ${FS}
      ${BUPTH} save  --name=${BS}               ${FS}

   else
      echo "${ME}> \"${FS}\" is not accessible, skipping..."
   fi

done
